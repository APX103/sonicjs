<script type='text/javascript'>

const formJSON = {{{ formJSON }}}

const formValuesToLoad = {{{ formValuesToLoad }}}

    loadModuleSettingForm = async function () {
        debugger;
        Formio.createForm(document.getElementById('formio'), formJSON).then((form) => {
            console.log('log form', form);

            if (formValuesToLoad) {
                form.submission = {
                    data: formValuesToLoad
                };
            }

            form.on('submit', async function (submission) {
                {{ onFormSubmitFunction }}
                // console.log('Submission was made!', submission);
                // debugger;
                // let entity = processContentFields(submission.data)
                // if (submission.data.id) {
                //     await editContentInstance(entity);
                // }
                // else {
                //     await createContentInstance(entity);
                // }
            });

            // Everytime the form changes, this will fire.
            form.on('change', function (changed) {
                console.log('Form was changed', changed);
            });

        });
    };

    window.onload = async function () {
        debugger;
        if (typeof module === 'undefined') {
            loadModuleSettingForm();
        }
    }

</script>

<div id='formio'></div>